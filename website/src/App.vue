<template>
    <div class="app">
        <div class="currentColor">
            <div class="currentColorBg"></div>
            <div
                class="topPart"
                :style="{ backgroundColor: validatedColor }"
            ></div>
            <div
                class="bottomPart"
                :style="{ backgroundColor: validatedColor }"
            ></div>
        </div>
        <nav>
            <div class="navItems">
                <svg
                    width="181"
                    height="31"
                    viewBox="0 0 181 31"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    class="logo"
                >
                    <path
                        d="M8.76 30.64C5.74667 30.64 3.53333 29.88 2.12 28.36C0.706667 26.84 0 24.32 0 20.8C0 18 0.466667 14.9867 1.4 11.76C2.36 8.53333 3.88 5.77333 5.96 3.48C8.06667 1.16 10.7333 0 13.96 0C15.96 0 17.5733 0.440001 18.8 1.32C20.0267 2.2 20.64 3.54667 20.64 5.36C20.64 6.50667 20.4133 7.41333 19.96 8.08C19.5067 8.72 18.8 9.04 17.84 9.04C16.88 9.04 16.12 8.69333 15.56 8C16.04 7.76 16.4667 7.28 16.84 6.56C17.2133 5.84 17.4 5.09333 17.4 4.32C17.4 3.6 17.2 3.01333 16.8 2.56C16.4267 2.10667 15.8133 1.88 14.96 1.88C13.5467 1.88 12.2 2.85333 10.92 4.8C9.64 6.72 8.6 9.14667 7.8 12.08C7.02667 15.0133 6.64 17.84 6.64 20.56C6.64 22.5867 6.98667 24.1333 7.68 25.2C8.37333 26.2667 9.62667 26.8 11.44 26.8C13.0133 26.8 14.4667 26.4533 15.8 25.76C17.1333 25.0667 18.28 24.08 19.24 22.8L20.16 23.2C19.4933 24.88 18.5067 26.28 17.2 27.4C15.8933 28.52 14.4933 29.3467 13 29.88C11.5067 30.3867 10.0933 30.64 8.76 30.64Z"
                        fill="white"
                    />
                    <path
                        d="M24.9628 30.16C22.9895 30.16 21.4295 29.6533 20.2828 28.64C19.1361 27.6267 18.5628 26.0267 18.5628 23.84C18.5628 22.0267 18.9361 20.0133 19.6828 17.8C20.4295 15.5867 21.6295 13.68 23.2828 12.08C24.9361 10.4533 27.0161 9.64 29.5228 9.64C32.9361 9.64 34.6428 11.7733 34.6428 16.04V16.08C34.7228 16.1067 34.8695 16.12 35.0828 16.12C35.9628 16.12 36.9761 15.8933 38.1228 15.44C39.2695 14.96 40.3095 14.3867 41.2428 13.72L41.6028 14.8C40.8295 15.6267 39.8161 16.3333 38.5628 16.92C37.3361 17.48 35.9895 17.88 34.5228 18.12C34.3095 20.5467 33.7628 22.6667 32.8828 24.48C32.0028 26.2933 30.8695 27.6933 29.4828 28.68C28.0961 29.6667 26.5895 30.16 24.9628 30.16ZM26.5628 26.56C27.2028 26.56 27.8428 26.2 28.4828 25.48C29.1228 24.7333 29.6828 23.7333 30.1628 22.48C30.6428 21.2 30.9895 19.7867 31.2028 18.24C30.4828 18.08 30.1228 17.52 30.1228 16.56C30.1228 15.4667 30.5361 14.7467 31.3628 14.4C31.3095 13.52 31.1761 12.92 30.9628 12.6C30.7495 12.2533 30.3761 12.08 29.8428 12.08C28.9628 12.08 28.1095 12.72 27.2828 14C26.4561 15.28 25.7895 16.8133 25.2828 18.6C24.7761 20.3867 24.5228 21.96 24.5228 23.32C24.5228 24.6 24.6695 25.4667 24.9628 25.92C25.2561 26.3467 25.7895 26.56 26.5628 26.56Z"
                        fill="white"
                    />
                    <path
                        d="M40.6609 30.24C39.3809 30.24 38.3409 29.84 37.5409 29.04C36.7676 28.24 36.3809 27.04 36.3809 25.44C36.3809 24.7733 36.4876 23.9067 36.7009 22.84L40.9809 2.8L46.9009 2L42.3009 23.6C42.1943 24 42.1409 24.4267 42.1409 24.88C42.1409 25.4133 42.2609 25.8 42.5009 26.04C42.7676 26.2533 43.1943 26.36 43.7809 26.36C44.5543 26.36 45.2743 26.04 45.9409 25.4C46.6076 24.7333 47.0876 23.88 47.3809 22.84H49.0609C48.0743 25.72 46.8076 27.68 45.2609 28.72C43.7143 29.7333 42.1809 30.24 40.6609 30.24Z"
                        fill="white"
                    />
                    <path
                        d="M53.205 30.16C51.2317 30.16 49.6717 29.6533 48.525 28.64C47.3783 27.6267 46.805 26.0267 46.805 23.84C46.805 22.0267 47.1783 20.0133 47.925 17.8C48.6717 15.5867 49.8717 13.68 51.525 12.08C53.1783 10.4533 55.2583 9.64 57.765 9.64C61.1783 9.64 62.885 11.7733 62.885 16.04V16.08C62.965 16.1067 63.1117 16.12 63.325 16.12C64.205 16.12 65.2183 15.8933 66.365 15.44C67.5117 14.96 68.5517 14.3867 69.485 13.72L69.845 14.8C69.0717 15.6267 68.0583 16.3333 66.805 16.92C65.5783 17.48 64.2317 17.88 62.765 18.12C62.5517 20.5467 62.005 22.6667 61.125 24.48C60.245 26.2933 59.1117 27.6933 57.725 28.68C56.3383 29.6667 54.8317 30.16 53.205 30.16ZM54.805 26.56C55.445 26.56 56.085 26.2 56.725 25.48C57.365 24.7333 57.925 23.7333 58.405 22.48C58.885 21.2 59.2317 19.7867 59.445 18.24C58.725 18.08 58.365 17.52 58.365 16.56C58.365 15.4667 58.7783 14.7467 59.605 14.4C59.5517 13.52 59.4183 12.92 59.205 12.6C58.9917 12.2533 58.6183 12.08 58.085 12.08C57.205 12.08 56.3517 12.72 55.525 14C54.6983 15.28 54.0317 16.8133 53.525 18.6C53.0183 20.3867 52.765 21.96 52.765 23.32C52.765 24.6 52.9117 25.4667 53.205 25.92C53.4983 26.3467 54.0317 26.56 54.805 26.56Z"
                        fill="white"
                    />
                    <path
                        d="M67.6631 10H73.4231L72.9031 12.48C73.8098 11.68 74.6231 11.0667 75.3431 10.64C76.0898 10.2133 76.8898 10 77.7431 10C78.5965 10 79.2631 10.2933 79.7431 10.88C80.2498 11.4667 80.5031 12.1733 80.5031 13C80.5031 13.7733 80.2498 14.4533 79.7431 15.04C79.2365 15.6267 78.5298 15.92 77.6231 15.92C77.0365 15.92 76.6365 15.7867 76.4231 15.52C76.2365 15.2267 76.0898 14.8133 75.9831 14.28C75.9031 13.9333 75.8231 13.68 75.7431 13.52C75.6631 13.36 75.5165 13.28 75.3031 13.28C74.7431 13.28 74.2631 13.4 73.8631 13.64C73.4898 13.8533 72.9965 14.24 72.3831 14.8L69.1831 30H63.4231L67.6631 10Z"
                        fill="white"
                    />
                    <path
                        d="M100.694 3.16C100.134 3.08 99.6007 3.04 99.0941 3.04C97.0674 3.04 95.4807 3.69334 94.3341 5C93.1874 6.30667 92.6141 8.50667 92.6141 11.6C92.6141 12.5867 92.7074 13.28 92.8941 13.68C93.0807 14.0533 93.1741 14.2667 93.1741 14.32C91.7341 14.32 90.6541 14.0267 89.9341 13.44C89.2407 12.8267 88.8941 11.8267 88.8941 10.44C88.8941 8.54667 89.3607 6.82667 90.2941 5.28C91.2274 3.70667 92.7074 2.44 94.7341 1.48C96.7874 0.520001 99.3874 0.0400019 102.534 0.0400019C103.094 0.0400019 104.134 0.106668 105.654 0.240002C108.774 0.533334 111.161 0.680001 112.814 0.680001C114.974 0.680001 116.507 0.493334 117.414 0.120001C117.707 1.02667 117.854 1.90667 117.854 2.76C117.854 4.2 117.414 5.22667 116.534 5.84C115.654 6.45333 114.721 6.76 113.734 6.76C113.121 6.76 112.454 6.66667 111.734 6.48C111.041 6.26667 110.001 5.90667 108.614 5.4L106.174 4.52L100.694 30H94.9341L100.694 3.16ZM111.694 30.24C110.414 30.24 109.374 29.84 108.574 29.04C107.801 28.24 107.414 27.04 107.414 25.44C107.414 24.7733 107.521 23.9067 107.734 22.84L110.454 10H116.214L113.334 23.6C113.227 24 113.174 24.4267 113.174 24.88C113.174 25.4133 113.294 25.8 113.534 26.04C113.801 26.2533 114.227 26.36 114.814 26.36C115.587 26.36 116.307 26.04 116.974 25.4C117.641 24.7333 118.121 23.88 118.414 22.84H120.094C119.107 25.72 117.841 27.68 116.294 28.72C114.747 29.7333 113.214 30.24 111.694 30.24Z"
                        fill="white"
                    />
                    <path
                        d="M132.86 30.24C131.233 30.24 130.033 29.8133 129.26 28.96C128.513 28.08 128.14 27 128.14 25.72C128.14 25.16 128.206 24.5333 128.34 23.84C128.473 23.12 128.606 22.4267 128.74 21.76C128.9 21.0933 129.006 20.6667 129.06 20.48C129.273 19.5467 129.473 18.6267 129.66 17.72C129.846 16.8133 129.94 16.08 129.94 15.52C129.94 14.16 129.46 13.48 128.5 13.48C127.806 13.48 127.193 13.8267 126.66 14.52C126.126 15.1867 125.7 16.0667 125.38 17.16L122.66 30H116.9L121.14 10H126.9L126.46 12.08C127.793 10.5867 129.353 9.84 131.14 9.84C132.5 9.84 133.58 10.2133 134.38 10.96C135.18 11.7067 135.58 12.84 135.58 14.36C135.58 15.1333 135.486 16 135.3 16.96C135.113 17.8933 134.846 19.04 134.5 20.4C134.286 21.2267 134.086 22.04 133.9 22.84C133.74 23.6133 133.66 24.2267 133.66 24.68C133.66 25.2133 133.78 25.6267 134.02 25.92C134.26 26.2133 134.673 26.36 135.26 26.36C136.06 26.36 136.7 26.08 137.18 25.52C137.66 24.9333 138.14 24.04 138.62 22.84H140.3C139.313 25.7733 138.166 27.7467 136.86 28.76C135.58 29.7467 134.246 30.24 132.86 30.24Z"
                        fill="white"
                    />
                    <path
                        d="M142.575 30.24C141.295 30.24 140.255 29.84 139.455 29.04C138.682 28.24 138.295 27.04 138.295 25.44C138.295 24.7733 138.402 23.9067 138.615 22.84L141.015 11.6H139.695L140.015 10H141.335L142.535 4.48L148.455 3.68L147.095 10H149.495L149.175 11.6H146.775L144.215 23.6C144.108 24 144.055 24.4267 144.055 24.88C144.055 25.4133 144.175 25.8 144.415 26.04C144.682 26.2533 145.108 26.36 145.695 26.36C146.468 26.36 147.188 26.04 147.855 25.4C148.522 24.7333 149.002 23.88 149.295 22.84H150.975C149.988 25.72 148.722 27.68 147.175 28.72C145.628 29.7333 144.095 30.24 142.575 30.24Z"
                        fill="white"
                    />
                    <path
                        d="M154.999 30.24C153.026 30.24 151.492 29.7333 150.399 28.72C149.306 27.68 148.759 26.0667 148.759 23.88C148.759 22.04 149.119 20.0133 149.839 17.8C150.559 15.5867 151.732 13.68 153.359 12.08C154.986 10.4533 157.052 9.64 159.559 9.64C162.492 9.64 163.959 10.92 163.959 13.48C163.959 14.9733 163.532 16.3467 162.679 17.6C161.826 18.8533 160.692 19.8667 159.279 20.64C157.866 21.3867 156.359 21.8133 154.759 21.92C154.706 22.72 154.679 23.2533 154.679 23.52C154.679 24.8267 154.906 25.72 155.359 26.2C155.812 26.6533 156.546 26.88 157.559 26.88C158.999 26.88 160.226 26.5467 161.239 25.88C162.279 25.2133 163.412 24.2 164.639 22.84H165.999C163.039 27.7733 159.372 30.24 154.999 30.24ZM155.079 20C156.066 19.9467 156.999 19.6 157.879 18.96C158.786 18.32 159.506 17.5067 160.039 16.52C160.599 15.5333 160.879 14.4933 160.879 13.4C160.879 12.3067 160.546 11.76 159.879 11.76C158.919 11.76 157.972 12.6 157.039 14.28C156.132 15.96 155.479 17.8667 155.079 20Z"
                        fill="white"
                    />
                    <path
                        d="M167.351 10H173.111L172.591 12.48C173.497 11.68 174.311 11.0667 175.031 10.64C175.777 10.2133 176.577 10 177.431 10C178.284 10 178.951 10.2933 179.431 10.88C179.937 11.4667 180.191 12.1733 180.191 13C180.191 13.7733 179.937 14.4533 179.431 15.04C178.924 15.6267 178.217 15.92 177.311 15.92C176.724 15.92 176.324 15.7867 176.111 15.52C175.924 15.2267 175.777 14.8133 175.671 14.28C175.591 13.9333 175.511 13.68 175.431 13.52C175.351 13.36 175.204 13.28 174.991 13.28C174.431 13.28 173.951 13.4 173.551 13.64C173.177 13.8533 172.684 14.24 172.071 14.8L168.871 30H163.111L167.351 10Z"
                        fill="white"
                    />
                </svg>
                <div class="inputItem colorPicker">
                    <input type="text" v-model="data.color" />
                    <div class="colorInput">
                        <input type="color" v-model="data.color" />
                        <svg
                            width="32"
                            height="32"
                            viewBox="0 0 32 32"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M27.7 18.675C27.9073 17.7648 28.008 16.8335 28 15.9C27.95 9.2875 22.475 3.9375 15.875 4C13.0554 4.02973 10.3363 5.05142 8.19484 6.88581C6.05337 8.7202 4.62626 11.2501 4.16391 14.0317C3.70155 16.8133 4.23349 19.6688 5.66639 22.0973C7.09928 24.5259 9.34161 26.3722 12 27.3125C12.4522 27.4754 12.937 27.5268 13.4133 27.4623C13.8896 27.3978 14.3433 27.2194 14.7359 26.9421C15.1285 26.6648 15.4485 26.2969 15.6685 25.8696C15.8886 25.4423 16.0023 24.9681 16 24.4875V24C15.9983 23.6056 16.0748 23.2147 16.225 22.85C16.3751 22.4853 16.596 22.1539 16.875 21.875C17.1539 21.5961 17.4852 21.3752 17.85 21.225C18.2147 21.0748 18.6055 20.9983 19 21H24.775C25.4536 21.0004 26.1124 20.7708 26.6436 20.3485C27.1749 19.9262 27.5473 19.3362 27.7 18.675V18.675Z"
                                stroke="#8D8D8D"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="outline"
                            />
                            <path
                                d="M16 11C16.8284 11 17.5 10.3284 17.5 9.5C17.5 8.67157 16.8284 8 16 8C15.1716 8 14.5 8.67157 14.5 9.5C14.5 10.3284 15.1716 11 16 11Z"
                                fill="#8D8D8D"
                            />
                            <path
                                d="M10.375 14.25C11.2034 14.25 11.875 13.5784 11.875 12.75C11.875 11.9216 11.2034 11.25 10.375 11.25C9.54657 11.25 8.875 11.9216 8.875 12.75C8.875 13.5784 9.54657 14.25 10.375 14.25Z"
                                fill="#8D8D8D"
                            />
                            <path
                                d="M10.375 20.75C11.2034 20.75 11.875 20.0784 11.875 19.25C11.875 18.4216 11.2034 17.75 10.375 17.75C9.54657 17.75 8.875 18.4216 8.875 19.25C8.875 20.0784 9.54657 20.75 10.375 20.75Z"
                                fill="#8D8D8D"
                            />
                            <path
                                d="M21.625 14.25C22.4534 14.25 23.125 13.5784 23.125 12.75C23.125 11.9216 22.4534 11.25 21.625 11.25C20.7966 11.25 20.125 11.9216 20.125 12.75C20.125 13.5784 20.7966 14.25 21.625 14.25Z"
                                fill="#8D8D8D"
                            />
                        </svg>
                    </div>
                </div>
            </div>
        </nav>
        <main>
            <div class="topBar">
                <div class="tabs">
                    <div class="text">
                        <button
                            @click="data.onCombinations = false"
                            :class="{
                                tints: true,
                                active: !data.onCombinations,
                            }"
                        >
                            Tints
                        </button>
                        <button
                            @click="data.onCombinations = true"
                            :class="{
                                combinations: true,
                                active: data.onCombinations,
                            }"
                        >
                            Combinations
                        </button>
                    </div>
                    <div class="underline">
                        <div
                            :class="{
                                indicator: true,
                                onCombinations: data.onCombinations,
                            }"
                        ></div>
                    </div>
                </div>
                <div class="optionsContainer">
                    <h3>Copy as:</h3>
                    <div tabindex="0" class="inputItem dropDown">
                        <p>{{ data.textFormat }}</p>
                        <svg
                            width="32"
                            height="32"
                            viewBox="0 0 32 32"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M26 12L16 22L6 12"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
                        <div class="dropDownOptions">
                            <button @click="setTextFormat('CSS')">CSS</button>
                            <button @click="setTextFormat('SCSS')">SCSS</button>
                            <button @click="setTextFormat('Array')">
                                Array
                            </button>
                        </div>
                    </div>
                    <div tabindex="0" class="inputItem dropDown">
                        <p>{{ data.colorFormat }}</p>
                        <svg
                            width="32"
                            height="32"
                            viewBox="0 0 32 32"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M26 12L16 22L6 12"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
                        <div class="dropDownOptions">
                            <button @click="setColorFormat('Hex')">Hex</button>
                            <button @click="setColorFormat('Rgba')">
                                Rgba
                            </button>
                            <button @click="setColorFormat('Hsla')">
                                Hsla
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <tints-view v-if="!data.onCombinations" :color="validatedColor" :key="validatedColor" />
            <combinations-view
                v-if="data.onCombinations"
                :color="validatedColor"
                :key="validatedColor"
            />
        </main>
    </div>
</template>

<script setup lang="ts">
import { reactive, computed, onMounted, onBeforeUnmount } from "vue";
import { parseToHsla, readableColor } from "color2k";
import tintsView from "./components/tintsView.vue";
import combinationsView from "./components/combinationsView.vue";
import { useStore } from "vuex";

const store = useStore()
const data = reactive({
    color: "#8001dd",
    onCombinations: false,
    textFormat: "CSS",
    colorFormat: "Hex",
});

onMounted(() => {
    data.textFormat = store.state.textFormat
    data.colorFormat = store.state.colorFormat
})

const validatedColor = computed(() => {
    try {
        const validator = parseToHsla(data.color);
        return data.color;
    } catch {
        return "#d7d7d7";
    }
});
const readableTextColor = computed(() => {
    try {
        return readableColor(data.color);
    } catch {
        return "#000000";
    }
});

function setColorFormat(format: string) {
    data.colorFormat = format;
    store.commit("setColorFormat", format);
}
function setTextFormat(format: string) {
    data.textFormat = format;
    store.commit("setTextFormat", format);
}
</script>

<style>
.tints-enter-active,
.tints-leave-active {
    transition: opacity 0.5s, transform 0.5s;
}

.tints-enter-from,
.tints-leave-to {
    opacity: 0;
    transform: translateX(-50px);
    transition: none;
}
.combs-enter-active,
.combs-leave-active {
    transition: opacity 0.5s, transform 0.5s;
}

.combs-enter-from,
.combs-leave-to {
    opacity: 0;
    transform: translateX(50px);
    transition: none;
}
</style>
